function closer(){for(var e=this;!e.parentElement.classList.contains("modal--show");)e=e.parentElement;e.parentElement.classList.remove("modal--show")}function show_modal(e,t){for(var o=document.querySelectorAll(e),a=o.length,n=0;n<a;n++)o[n].addEventListener("click",function(e){e.preventDefault(),document.getElementsByClassName(t)[0].classList.add("modal--show")})}function click_modal(e,o){if(e=document.querySelector(e)){o=e.querySelector(o);e.addEventListener("click",function(e){var t=o.getBoundingClientRect();e.pageX>t.left&&e.pageX<t.right&&e.pageY>t.top+pageYOffset&&e.pageY<t.bottom+pageYOffset||this.classList.remove("modal--show")})}}for(var maxi=(is=document.getElementsByClassName("role-close")).length,i=0;i<maxi;i++)is[i].addEventListener("click",closer);if(show_modal(".contacts .main-button","modal--write-us"),show_modal(".contacts__map a","modal--map"),window.addEventListener("keydown",function(e){if(27==e.keyCode){var t=document.querySelector(".modal--show");t&&(e.preventDefault(),t.classList.remove("modal--show"))}}),click_modal(".modal--cart-plus",".dialog"),click_modal(".modal--map",".map-popup"),click_modal(".modal--write-us",".dialog"),"ontouchstart"in document.documentElement){function setPEStyleToBtn(){for(var e=document.querySelectorAll(".tool__button"),t=e.length,o=0;o<t;o++)e[o].style.pointerEvents="none"}for(maxi=(is=document.querySelectorAll(".tool")).length,i=0;i<maxi;i++)is[i].querySelectorAll(".tool__button").forEach(function(e){e.style.pointerEvents="none",e.addEventListener("click",function(e){e.preventDefault(),this.style.pointerEvents="none";var t=this.classList.contains("tool__button--buy")?document.querySelector(".button-cart"):document.querySelector(".button-bookmarks");t.classList.add("button-cart--full"),t.innerText=t.innerText.replace(/(\d+)/,function(e){return Number(e)+1}),this.classList.contains("tool__button--buy")&&document.getElementsByClassName("modal--cart-plus")[0].classList.add("modal--show")})}),is[i].addEventListener("click",function(e){e.target.classList.contains("tool__button")||(setPEStyleToBtn(),this.querySelectorAll(".tool__button").forEach(function(e){e.style.pointerEvents="auto"}))})}else{for(maxi=(is=document.getElementsByClassName("tool__button--buy")).length,i=0;i<maxi;i++)is[i].addEventListener("click",function(e){e.preventDefault();var t=document.getElementsByClassName("button-cart")[0];t.classList.add("button-cart--full"),t.innerText=t.innerText.replace(/(\d+)/,function(e){return Number(e)+1}),document.getElementsByClassName("modal--cart-plus")[0].classList.add("modal--show")});var is;for(maxi=(is=document.getElementsByClassName("tool__button--bookmark")).length,i=0;i<maxi;i++)is[i].addEventListener("click",function(e){e.preventDefault();var t=document.getElementsByClassName("button-bookmarks")[0];t.classList.add("button-cart--full"),t.innerText=t.innerText.replace(/(\d+)/,function(e){return Number(e)+1})})}var form=document.querySelector(".write-us"),user_name=form.querySelector("[name=user-name]"),email=form.querySelector("[name=email]"),text=form.querySelector("[name=text]"),isStorage=!0;try{user_name.value=localStorage.getItem("user_name"),text.value=localStorage.getItem("text"),email.value=localStorage.getItem("email")}catch(e){user_name.value="",text.value="",email.value="",isStorage=!1}document.querySelector(".contacts .main-button").addEventListener("click",function(){form.classList.remove("error"),""===user_name.value?user_name.focus():""===email?email.focus():text.focus()}),form.addEventListener("submit",function(e){""!=text.value&&/@/.test(email.value)||(e.preventDefault(),form.classList.remove("error"),form.offsetWidth=form.offsetWidth,form.classList.add("error")),isStorage&&(localStorage.setItem("user_name",user_name.value),localStorage.setItem("text",text.value),localStorage.setItem("email",email.value))});
